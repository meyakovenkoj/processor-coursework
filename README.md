# Проектирование процессор ЭВМ

## 1 слайд

Добрый день! Я, студент группы Б17-503, Яковенко Иван представвляю вам курсовой проект на тему "Проектирование процессора ЭВМ"

## 2 слайд

Спроектированный процессор выполняет 4 операции:
УМНОЖЕНИЕ чисел со знаком с младших разрядов
ПЕРЕСЫЛКУ ОТРИЦАТЕЛЬНУЮ – то есть взятие отрицательного значения модуля числа. Так же устанавливается признак результата равный знаку результата (1 если число меньше нуля, 0 если число равно нулю)
И два перехода:
Условный переход, если признак результата равен 1
Безусловный переход
Адрес перехода задается в виде смещения в дополнительном коде.

## 3 слайд

Для размещения команд в памяти были разработаны представленные форматы. Первый операнд команды УМНОЖЕНИЕ и ПЕРЕСЫЛКА ОТРИЦАТЕЛЬНАЯ задается всегда при помощи прямой адресации. Второй операнд, в зависимости от признака адресации PA2, указывается либо с помощью прямой адресации, либо с помощью постиндексной косвенной. Для экономного использования памяти расположение полей команд было размещено в 2, 3 или 4 словах. Для команд перехода используется относительная адресация и соответственно смещение со знаком, которое указывается в команде. Если прямые и относительные адресации, думаю всем понятны, остановимся на постиндексной косвенной адресации. Её схема показана справа на слайде. В команде указывается номер регистра, в котором хранится базовый адрес, используемый в качестве косвенного, и непосредственно смещение. При этом, так как базовый адрес занимает пять разрядов, его старший бит должен храниться в ячейке с четным адресом. Так как логический адрес в ОП должен содержать 5 разрядов, смещение, полученное из регистра, расширяется нулем справа до 5 разрядов. Сумма смещения, полученного из кода команды, и базового адреса, полученного из ОП, является исполнительным адресом операнда.

## 4 слайд

Центральным управляющим блоком спроектированного процессора является блок выработки микрокоманд. БМК был спроектирован на основе алгоритма микропрограммы. Для организации выполнения микропрограммы была использована принудительная адресация. Для хранения адреса микрокоманды - регистр адреса микрокоманды. В микрокоманде, кроме вырабатываемых управляющих сигналов, указываются так же адрес следующей микрокоманды и признаки, проверяемые в случае ветвления.
Если не указан ни один признак, тогда ветвления не происходит, и в регистр адреса микрокоманды записывается адрес, указанный в микрокоманде. Если указан хотя бы один признак, тогда в микропрограмме возможно ветвление на 2 направления. В случае равенства единице хотя бы ондго из признаков, указанных в микрокоманде, в регистр адреса микрокоманды загружается адрес, идущий следующим за адресом из адресного поля микрокоманды. В противном случае записывается сам адрес, указанный в адресном поле микрокоманды. При этом, в случае ветвления, адрес перехода всегда должен быть четным.
Процесс ветвления основан на изменении младшего разряда адреса следующей микрокоманды нулем или единицей, в случае когда указан хоть один признак.

## 5 слайд

Была разработана блок-схема алгоритма выполнения последовательности команд, который лег в основу спроектированного БМК. Серьезным требованием при разработке алгоритма явилось соблюдение правильной расстановки адресов, так как адрес переход всегда должен быть четным. В алгоритме присутствует необходимость ветвления более чем на 2 направления, для этой цели были добавлены микрокоманды, не вырабатывающие управляющих сигналов (NOP). Каждой представленной на блок-схеме микрокоманде поставлен в соответствие набор сигналов, управляющих работой блока управления командами, функциональная схема которого представлена на следующем слайде.
Для выполнения любой микрокоманды считываются минимум два слова. Далее определяется тип команды – если команда нелинейная, то уходим на выполнение условного или безусловного перехода. В ином случае считывается еще одно слово и определяется тип адресации по признаку PA2. Для постиндексной косвенной нужно будет прочитать 4 слово.Далее выполняется считывание второго операнда и выработка сигнала начала работы АЛУ. После окончания работы АЛУ результат записывается в соответствующую ячейку соответствующей памяти и выполнение команды заканчивается.

## 6 слайд

Основными задачами БУК являются хранение и формирование адреса следующей выполняемой команды, считывание операндов и передача их в АЛУ и запись результата вычисления по окончанию работы АЛУ.
Регистр команд состоит из 4 четырех-словных регистров хранения.
Для реализации постиндексной косвенной адресации был введен регистр исполнительного адреса RIA. В него последовательно записывается адрес из регистровой памяти, расширенный нулем, базовый адрес из оперативной памяти и наконец сумма базы и смещения для обращения к оперативной памяти по исполнительному адресу.
Для выбора четного ии нечетного слова из оперативной памяти используется младший разряд адреса. На адресный вход подаются оставшиеся 4 разряда адреса.
Для записи в ОП только одного слова используется два коммутатора, управляемых младшим разрядом исполнительного адреса. В случае равенства этого разряда единице в ячейку ОП записываются старшие 4 разряда текущего содержимого этой ячейки и результат операции. В случае равенства нулю - результат выполнения операции и младшие 4 разряда текущего содержимого.

## 7 слайд

Основная логика работы АЛУ обусловлена блоком операций. Данный блок был спроектирован для выполнения двух, указанных в тех задании операций.
Так как операции выполняются в дополнительном коде и при инвертировании необходимо прибавлять 1, управляющий сигнал Y5 второй комбинационной схемы, отвечающей за инвертирование числа так же заведен на сумматор в качестве входа переноса.
Для реализации алгоритма умножения чисел с младших разрядов множителя и сдвигом частичных произведений вправо путем последовательного преобразования множителя в качестве регистра второго операнда и регистра результата были взяты сдвиговые регистры на 5 и 4 разряда. В регистре второго операнда выдвигаемый младший разряд остается в 5 разряде, позволяя тем самым проще анализировать последние два разряда (на схеме F1 и F2).
Для второй операции анализируется знак второго операнда и далее в регистр результата записывается прямое или обратное значение числа. Знак результата сохраняется в качестве признака в триггере признака результата (TPR).
Управление БО производится при помощи МУУ, вместе они образуют АЛУ.

## 8 слайд

На слайде показан пример работы АЛУ на функциональном моделировании. Операнд A = 1.010 или -6/8, операнд B = 0.110 или 6/8. При перемножении ожидаемый результат должен быть -36/64 или при обрезке до 4 битов -5/8 то есть 1.011. Этапы вычисления проиллюстрированы с помощью примера вычисленного вручную. Для проверки старта МУУ не с нулевого состояния тест был запущен дважды.
В процессе тестирования было выяснено, что минимальное число тактов достигается при операнде B = 0. Максимальное число тактов при B = 5.

## 9 слайд

Для отладки процессора было проведено его тестирование. Данный тест обеспечивает:

- Проверку всех микрокоманд алгоритма (проход по всем веткам алгоритма)
- Проверку считывания команд разного формата, расположенных по четным и нечетным адресам в оперативной памяти (напр., первое умножение и пересылка)
- Проверку считывания операндов из оперативной памяти, расположенных по четным и нечетным адресам (D и F)
- Проверку записи результата в оперативную память по четным и нечетным адресам (D и F, в операциях пересылки)
- Проверку считывания операндов из регистровой памяти (C/K)
- Проверку записи операндов в регистровую память (K)
- Проверку всех используемых способов адресации (все])
- Проверку правильности вычисления признака перехода (есть или нет переход на А16)
- Проверку правильности работы АЛУ (значения совпадают с рассчитанными вручную)

Размещение команды в памяти представлено на рисунке слева.
Значения, вырабатываемые процессором полностью совпадают со значениями, рассчитанными вручную.
Соответственно на рассчитанном примере показан ход выполнения программы. Изогнутыми стреклками показана связь между записанными и считанными значениями. Изображен процесс вычисления исполнительного адреса для операндов с использованием постиндексной косвенной адресации.

# Заключение

Таким образом, для реализации процессора было спроектировано 4 основных блока:

- БО - для выполнения операций
- МУУ - для задания последовательности микроопераций БО
- БУК - для обработки команд
- БМК - для задания последовательности микрокоманд

Для каждого из блоков было выполнено моделирование и тестирование. Блоки были соединены вместе, образуя процессор.
В качестве дальнейшего развития проекта предлагается вкючение новых команд для процессора таких как СТОП, возможно написание своего рода транслятора из более понятного человеку кода в машинные слова.
